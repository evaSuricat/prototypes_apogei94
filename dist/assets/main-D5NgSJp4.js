(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function i(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(a){if(a.ep)return;a.ep=!0;const r=i(a);fetch(a.href,r)}})();function ee(){const t=(window.location.pathname||"").split("/").filter(Boolean).pop()||"";return t===""||t==="index.html"?"index.html":t}function te(e){if(!e)return"";try{const i=new URL(e,window.location.origin).pathname.split("/").filter(Boolean).pop()||"";return i===""?"index.html":i}catch{const t=e.split("/").filter(Boolean).pop()||e;return t===""?"index.html":t}}function ie(e=document){const t=e.querySelectorAll(".header .nav-links a");if(!t.length)return;const i=ee();t.forEach(n=>{te(n.getAttribute("href"))===i?(n.classList.add("active"),n.setAttribute("aria-current","page")):(n.classList.remove("active"),n.removeAttribute("aria-current"))})}function ne(e=document){ie(e)}const v={currentAmount:50,currentFrequency:"one-time"};function ae(e){return{meals:Math.round(e/3.33),hours:Math.round(e/10),workshops:Math.round(e/16.67)}}function R(e=document){const t=e.getElementById("display-amount"),i=e.getElementById("button-amount"),n=e.getElementById("impact-1"),a=e.getElementById("impact-2"),r=e.getElementById("impact-3"),u=e.querySelectorAll(".amount-btn"),b=e.getElementById("custom-amount");t&&(t.textContent=v.currentAmount),i&&(i.textContent=`${v.currentAmount}‚Ç¨`);const y=ae(v.currentAmount);n&&(n.textContent=`${y.meals} repas adapt√©s`),a&&(a.textContent=`${y.hours}h d'accompagnement`),r&&(r.textContent=`${y.workshops} ateliers th√©rapeutiques`),u.forEach(A=>{const M=parseInt(A.dataset.amount,10);A.classList.toggle("active",M===v.currentAmount)}),b&&b.value&&parseInt(b.value,10)!==v.currentAmount&&u.forEach(A=>A.classList.remove("active"))}function se(e){return e&&e>=1&&e<=1e4}function oe(e,t){const i=e.currentTarget,n=parseInt(i.dataset.amount,10);if(!isNaN(n)){v.currentAmount=n;const a=t.getElementById("custom-amount");a&&(a.value=""),R(t)}}function re(e,t){const i=parseInt(e.target.value,10);se(i)&&(v.currentAmount=i,R(t))}function le(e){const t=e.currentTarget,i=t.dataset.frequency;i&&(v.currentFrequency=i,document.querySelectorAll(".frequency-btn").forEach(a=>a.classList.remove("active")),t.classList.add("active"))}function ce(e){e.preventDefault();const t=v.currentFrequency==="one-time"?"Unique":"Mensuel";console.log("‚úÖ Redirection vers le paiement s√©curis√©"),console.log(`Montant: ${v.currentAmount}‚Ç¨`),console.log(`Fr√©quence: ${t}`),console.log("Int√©gration HelloAsso/Stripe √† impl√©menter")}function de(e=document){const t=e.getElementById("donate-form");if(!t){console.warn("‚ö†Ô∏è Formulaire de don non trouv√© (#donate-form). Calculateur non initialis√©.");return}const i=e.querySelectorAll(".amount-btn"),n=e.getElementById("custom-amount"),a=e.querySelectorAll(".frequency-btn");i.forEach(r=>{r.addEventListener("click",u=>oe(u,e))}),n&&n.addEventListener("input",r=>re(r,e)),a.forEach(r=>{r.addEventListener("click",le)}),t.addEventListener("submit",ce),R(e),console.log("‚úÖ Donation Calculator initialized"),console.log("üí∞ Impact Calculator active")}const E=[{id:1,name:"IME Bel Air",type:"etablissement",pole:"education",poleLabel:"√âducation, apprentissage & loisirs",location:"Cr√©teil",locationSlug:"creteil",ageGroup:["enfants","ados"],description:"Institut M√©dico-√âducatif accompagnant enfants et adolescents en situation de handicap avec projet p√©dagogique personnalis√©.",image:"https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",tags:["Scolarit√©","√âducation","Soins"],capacity:"60 places",staff:"45 professionnels",year:"1985",coords:{lat:48.7903,lng:2.4555}},{id:2,name:"ESAT Les Jardins",type:"etablissement",pole:"professionnelle",poleLabel:"Vie professionnelle et citoyenne",location:"Saint-Maur-des-Foss√©s",locationSlug:"saint-maur",ageGroup:["adultes"],description:"√âtablissement et Service d'Aide par le Travail proposant activit√©s d'espaces verts, conditionnement et cuisine collective.",image:"https://images.unsplash.com/photo-1556761175-b413da4baf72?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",tags:["Travail adapt√©","Insertion","Espaces verts"],capacity:"120 travailleurs",staff:"15 moniteurs",year:"1992",coords:{lat:48.8014,lng:2.4856}},{id:3,name:"SESSAD Horizon",type:"dispositif",pole:"education",poleLabel:"√âducation, apprentissage & loisirs",location:"Vitry-sur-Seine",locationSlug:"vitry",ageGroup:["enfants","ados"],description:"Service d'√âducation Sp√©ciale et de Soins √† Domicile pour accompagnement en milieu ordinaire (√©cole, domicile).",image:"https://images.unsplash.com/photo-1576091160399-112ba8d25d1d?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",tags:["Domicile","Scolarit√©","Soins"],capacity:"80 accompagn√©s",staff:"25 intervenants",year:"2001",coords:{lat:48.7875,lng:2.3933}},{id:4,name:"FAM Les Oliviers",type:"etablissement",pole:"medicalise",poleLabel:"√âtablissements et services m√©dicalis√©s",location:"Champigny-sur-Marne",locationSlug:"champigny",ageGroup:["adultes"],description:"Foyer d'Accueil M√©dicalis√© pour adultes n√©cessitant un soutien m√©dical et √©ducatif constant.",image:"https://images.unsplash.com/photo-1581093450021-4a7360e9a6b5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",tags:["M√©dicalis√©","H√©bergement","Soins"],capacity:"60 r√©sidents",staff:"35 professionnels",year:"1998",coords:{lat:48.8172,lng:2.5156}},{id:5,name:"SAV Autonomie",type:"dispositif",pole:"habitat",poleLabel:"Habitat & vie sociale",location:"Ivry-sur-Seine",locationSlug:"ivry",ageGroup:["adultes"],description:"Service d'Accompagnement √† la Vie pour favoriser l'autonomie et l'inclusion sociale en milieu ordinaire.",image:"https://images.unsplash.com/photo-1551836022-d5d88e9218df?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",tags:["Autonomie","Social","Inclusion"],capacity:"150 accompagn√©s",staff:"25 accompagnateurs",year:"2010",coords:{lat:48.8139,lng:2.3864}},{id:6,name:"MAS Le Domaine",type:"etablissement",pole:"medicalise",poleLabel:"√âtablissements et services m√©dicalis√©s",location:"Bonneuil-sur-Marne",locationSlug:"bonneuil",ageGroup:["adultes"],description:"Maison d'Accueil Sp√©cialis√©e pour adultes en situation de handicap lourd n√©cessitant assistance constante.",image:"https://images.unsplash.com/photo-1517487881594-2787fef5ebf7?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",tags:["Handicap lourd","Soins continus","H√©bergement"],capacity:"50 r√©sidents",staff:"40 soignants",year:"2003",coords:{lat:48.7733,lng:2.4889}},{id:7,name:"UEMA Les Tulipes",type:"dispositif",pole:"education",poleLabel:"√âducation, apprentissage & loisirs",location:"Le Perreux-sur-Marne",locationSlug:"le-perreux",ageGroup:["enfants"],description:"Unit√© d'Enseignement Maternel Autis√©e pour scolarisation d'enfants avec troubles du spectre autistique.",image:"https://images.unsplash.com/photo-1503454537995-182c148bce7e?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",tags:["Autisme","Scolarit√©","Petite enfance"],capacity:"12 enfants",staff:"8 professionnels",year:"2018",coords:{lat:48.8444,lng:2.5111}},{id:8,name:"Foyer La Maison Verte",type:"etablissement",pole:"habitat",poleLabel:"Habitat & vie sociale",location:"Nogent-sur-Marne",locationSlug:"nogent",ageGroup:["adultes"],description:"Foyer d'H√©bergement pour adultes en situation de handicap, accompagnement vers l'autonomie r√©sidentielle.",image:"https://images.unsplash.com/photo-1560448204-8cf87f3c39c4?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",tags:["H√©bergement","Autonomie","Vie sociale"],capacity:"45 r√©sidents",staff:"22 √©ducateurs",year:"1995",coords:{lat:48.8378,lng:2.4833}},{id:9,name:"MJPM Val-de-Marne",type:"dispositif",pole:"protection",poleLabel:"Protection juridique des majeurs",location:"Cr√©teil",locationSlug:"creteil",ageGroup:["adultes"],description:"Service de protection juridique pour majeurs sous tutelle ou curatelle, accompagnement dans les actes de la vie civile.",image:"https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",tags:["Tutelle","Curatelle","Protection"],capacity:"900 majeurs prot√©g√©s",staff:"30 mandataires",year:"1988",coords:{lat:48.7903,lng:2.4555}},{id:10,name:"DAR Les Sources",type:"dispositif",pole:"education",poleLabel:"√âducation, apprentissage & loisirs",location:"Vitry-sur-Seine",locationSlug:"vitry",ageGroup:["ados"],description:"Dispositif d'Accueil et de R√©pit pour adolescents en situation de handicap, soutien aux familles.",image:"https://images.unsplash.com/photo-1529156069898-49953e39b3ac?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",tags:["Adolescents","R√©pit","Accueil temporaire"],capacity:"8 places",staff:"12 professionnels",year:"2015",coords:{lat:48.7875,lng:2.3933}}],o={filters:{type:"all",pole:"",location:"",age:"",search:""},activeChips:[],currentPage:1,itemsPerPage:6,viewMode:"list",sortBy:"relevance",map:null,mapMarkers:[]};let s={};function ue(e,t){let i;return function(...a){const r=()=>{clearTimeout(i),e(...a)};clearTimeout(i),i=setTimeout(r,t)}}function I(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function W(e){return{education:"√âducation",medicalise:"M√©dicalis√©",habitat:"Habitat",professionnelle:"Professionnel",protection:"Protection"}[e]||e}function $(e,t){let i=[...t];if(e.filters.type!=="all"&&(i=i.filter(n=>n.type===e.filters.type)),e.filters.pole&&(i=i.filter(n=>n.pole===e.filters.pole)),e.filters.location&&(i=i.filter(n=>n.locationSlug===e.filters.location)),e.filters.age&&(i=i.filter(n=>n.ageGroup.includes(e.filters.age))),e.filters.search){const n=e.filters.search.toLowerCase();i=i.filter(a=>a.name.toLowerCase().includes(n)||a.location.toLowerCase().includes(n)||a.description.toLowerCase().includes(n)||a.tags.some(r=>r.toLowerCase().includes(n)))}return i}function pe(e,t){switch(t){case"name-asc":return e.sort((i,n)=>i.name.localeCompare(n.name));case"name-desc":return e.sort((i,n)=>n.name.localeCompare(i.name));case"location":return e.sort((i,n)=>i.location.localeCompare(n.location));default:return e}}function fe(e,t,i){const n=Math.ceil(e.length/i),a=(t-1)*i;return{items:e.slice(a,a+i),totalPages:n}}function ge(e){const t=e.type==="dispositif"?"badge-dispositif":"badge-type",i=e.type==="dispositif"?"Dispositif":"√âtablissement";return`
    <article class="result-card" role="listitem" tabindex="0" aria-labelledby="result-title-${e.id}">
      <div class="result-media">
        <img src="${e.image}" alt="${I(e.name)} - ${I(e.location)}" loading="lazy">
        <div class="result-badges">
          <span class="badge badge-pole">${I(W(e.pole))}</span>
          <span class="badge ${t}">${i}</span>
        </div>
      </div>
      <div class="result-content">
        <div class="result-location">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M8 1C5.5 1 3.5 3 3.5 5.5C3.5 8.5 8 14 8 14C8 14 12.5 8.5 12.5 5.5C12.5 3 10.5 1 8 1Z" stroke="#636363" stroke-width="1.5"/>
            <circle cx="8" cy="5.5" r="2" stroke="#636363" stroke-width="1.5"/>
          </svg>
          ${I(e.location)}
        </div>
        <h3 class="result-title">
          <a href="etablissement-detail.html?id=${e.id}" id="result-title-${e.id}">
            ${I(e.name)}
          </a>
        </h3>
        <p class="result-description">${I(e.description)}</p>
        <div class="result-meta">
          <span class="meta-item">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M7 1C4.5 1 2.5 3 2.5 5.5C2.5 8.5 7 13 7 13C7 13 11.5 8.5 11.5 5.5C11.5 3 9.5 1 7 1Z" stroke="#636363" stroke-width="1"/>
              <circle cx="7" cy="5.5" r="1.5" stroke="#636363" stroke-width="1"/>
            </svg>
            ${e.ageGroup.map(n=>n==="enfants"?"Enfants":n==="ados"?"Ados":"Adultes").join(", ")}
          </span>
          <span class="meta-item">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <circle cx="7" cy="4" r="2" stroke="#636363" stroke-width="1"/>
              <path d="M2 12C2 9.23858 4.23858 7 7 7C9.76142 7 12 9.23858 12 12" stroke="#636363" stroke-width="1" stroke-linecap="round"/>
            </svg>
            ${e.capacity}
          </span>
        </div>
        <div class="result-tags">
          ${e.tags.slice(0,3).map(n=>`<span class="tag">${I(n)}</span>`).join("")}
          ${e.tags.length>3?`<span class="tag">+${e.tags.length-3}</span>`:""}
        </div>
        <div class="result-actions">
          <a href="etablissement-detail.html?id=${e.id}" class="btn btn-outline">D√©couvrir</a>
          <a href="contact.html?etablissement=${e.id}" class="btn btn-primary">Contacter</a>
        </div>
      </div>
    </article>
  `}function J(e){console.log("üìã renderResults appel√© avec",e.length,"r√©sultats");const{items:t,totalPages:i}=fe(e,o.currentPage,o.itemsPerPage);if(t.length===0){s.gridView.classList.add("hidden"),s.gridView.hidden=!0,s.emptyState.classList.remove("hidden"),s.emptyState.hidden=!1,s.pagination.classList.add("hidden"),s.pagination.hidden=!0;return}s.emptyState.classList.add("hidden"),s.emptyState.hidden=!0,s.gridView.classList.remove("hidden"),s.gridView.hidden=!1,s.gridView.style.display="grid",s.gridView.innerHTML=t.map(n=>ge(n)).join(""),console.log("‚úÖ Grille de r√©sultats rendue"),i>1?(me(i),s.pagination.classList.remove("hidden"),s.pagination.hidden=!1):(s.pagination.classList.add("hidden"),s.pagination.hidden=!0)}function me(e){let t="";t+=`<button class="pagination-btn" id="prev-page" aria-label="Page pr√©c√©dente" ${o.currentPage===1?"disabled":""}>
    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <path d="M12.5 15L7.5 10L12.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>`;const i=5;let n=Math.max(1,o.currentPage-Math.floor(i/2)),a=Math.min(e,n+i-1);a-n+1<i&&(n=Math.max(1,a-i+1)),n>1&&(t+='<button class="pagination-btn" data-page="1">1</button>',n>2&&(t+='<span class="pagination-ellipsis">‚Ä¶</span>'));for(let r=n;r<=a;r++)t+=`<button class="pagination-btn ${r===o.currentPage?"active":""}"
      data-page="${r}"
      aria-current="${r===o.currentPage?"page":"false"}"
      aria-label="Page ${r}">${r}</button>`;a<e&&(a<e-1&&(t+='<span class="pagination-ellipsis">‚Ä¶</span>'),t+=`<button class="pagination-btn" data-page="${e}">${e}</button>`),t+=`<button class="pagination-btn" id="next-page" aria-label="Page suivante" ${o.currentPage===e?"disabled":""}>
    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <path d="M7.5 5L12.5 10L7.5 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>`,s.pagination.innerHTML=t}function he(e){const t=o.filters.type==="etablissement"?"√©tablissement":o.filters.type==="dispositif"?"dispositif":"√©tablissement et dispositif",i=e>1?"s":"";s.resultsCount&&(s.resultsCount.textContent=`${e} ${t}${i}`),s.resultsTitle&&(o.filters.pole||o.filters.location||o.filters.search?s.resultsTitle.textContent="R√©sultats de recherche":s.resultsTitle.textContent=`Tous les ${t}${i}`)}function be(){if(!s.activeFiltersContainer)return;const e=[];if(o.filters.type!=="all"&&e.push({key:"type",label:o.filters.type==="etablissement"?"√âtablissements":"Dispositifs",value:o.filters.type}),o.filters.pole&&e.push({key:"pole",label:W(o.filters.pole),value:o.filters.pole}),o.filters.location){const t={creteil:"Cr√©teil","saint-maur":"Saint-Maur",vitry:"Vitry-sur-Seine",champigny:"Champigny-sur-Marne",ivry:"Ivry-sur-Seine",bonneuil:"Bonneuil-sur-Marne","le-perreux":"Le Perreux",nogent:"Nogent-sur-Marne"};e.push({key:"location",label:t[o.filters.location]||o.filters.location,value:o.filters.location})}if(o.filters.age){const t={enfants:"Enfants",ados:"Adolescents",adultes:"Adultes"};e.push({key:"age",label:t[o.filters.age],value:o.filters.age})}o.filters.search&&e.push({key:"search",label:`"${o.filters.search}"`,value:o.filters.search}),o.activeChips=e,s.activeFiltersContainer.innerHTML=e.map(t=>`
    <button class="filter-chip active" data-key="${t.key}" data-value="${t.value}" aria-label="Supprimer le filtre ${t.label}">
      ${t.label}
      <span class="remove" aria-hidden="true">√ó</span>
    </button>
  `).join("")}function ye(){if(s.clearFiltersBtn){const e=o.filters.type!=="all"||o.filters.pole||o.filters.location||o.filters.age||o.filters.search;s.clearFiltersBtn.hidden=!e}}function ve(e,t=[48.79,2.45],i=11){if(typeof L>"u")return console.warn("‚ö†Ô∏è Leaflet n'est pas charg√©. La carte ne peut pas √™tre initialis√©e."),null;e.innerHTML="";const n=L.map(e,{center:t,zoom:i,zoomControl:!0,scrollWheelZoom:!1});L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19}).addTo(n);const a=L.control({position:"bottomright"});return a.onAdd=function(){const r=L.DomUtil.create("div","map-legend");return r.innerHTML=`
      <div class="legend-item">
        <div class="legend-color etablissement"></div>
        <span>√âtablissement</span>
      </div>
      <div class="legend-item">
        <div class="legend-color dispositif"></div>
        <span>Dispositif</span>
      </div>
    `,r},a.addTo(n),n}function j(e,t){typeof L>"u"||(o.mapMarkers.forEach(i=>e.removeLayer(i)),o.mapMarkers=[],t.forEach(i=>{if(i.coords&&i.coords.lat&&i.coords.lng){const n=i.type==="dispositif"?"#cc209c":"#00619b",a=L.circleMarker([i.coords.lat,i.coords.lng],{radius:12,fillColor:n,color:"#ffffff",weight:2,opacity:1,fillOpacity:.8}).bindPopup(`
        <strong>${i.name}</strong><br>
        ${i.location}<br>
        <small>${i.poleLabel}</small>
      `);a.addTo(e),o.mapMarkers.push(a)}}),console.log(`üìç ${o.mapMarkers.length} marqueurs affich√©s`))}function we(e){if(o.viewMode=e,s.viewButtons.forEach(t=>{const i=t.dataset.view===e;t.classList.toggle("active",i),t.setAttribute("aria-selected",i),t.setAttribute("aria-pressed",i)}),e==="grid"||e==="list"){if(console.log("üìã Passage en vue Liste"),s.gridView.innerHTML===""){console.log("üîÑ La grille est vide, re-rendu des r√©sultats...");const t=$(o,E);J(t)}s.gridView.classList.remove("hidden"),s.gridView.hidden=!1,s.gridView.style.display="grid",s.mapView.classList.add("hidden"),s.mapView.hidden=!0,s.mapView.style.display="none"}else if(e==="map"){if(console.log("üó∫Ô∏è Passage en vue Carte"),s.gridView.classList.add("hidden"),s.gridView.hidden=!0,s.gridView.style.display="none",s.mapView.classList.remove("hidden"),s.mapView.hidden=!1,s.mapView.style.display="block",!o.map&&s.mapContainer)console.log("üó∫Ô∏è Initialisation de la carte Leaflet..."),console.log("üì¶ mapContainer:",s.mapContainer),setTimeout(()=>{if(console.log("‚è∞ Initialisation en cours..."),o.map=ve(s.mapContainer),o.map){console.log("‚úÖ Carte initialis√©e avec succ√®s");const t=$(o,E);j(o.map,t),setTimeout(()=>{o.map.invalidateSize(),console.log("üîÑ invalidateSize() appel√©")},200)}else console.error("‚ùå √âchec de l'initialisation de la carte")},100);else if(o.map){console.log("üó∫Ô∏è La carte existe d√©j√†, mise √† jour des marqueurs...");const t=$(o,E);j(o.map,t),setTimeout(()=>{o.map.invalidateSize()},100)}}}function Le(){s.typeTabs.forEach(e=>{e.addEventListener("click",()=>{s.typeTabs.forEach(t=>{t.classList.remove("active"),t.setAttribute("aria-selected","false")}),e.classList.add("active"),e.setAttribute("aria-selected","true"),o.filters.type=e.dataset.type,o.currentPage=1,C()})})}function Se(){if(!s.searchInput)return;const e=ue(()=>{o.filters.search=s.searchInput.value.trim(),o.currentPage=1,C()},300);s.searchInput.addEventListener("input",e)}function Ce(){s.poleSelect&&s.poleSelect.addEventListener("change",()=>{o.filters.pole=s.poleSelect.value,o.currentPage=1,C()}),s.locationSelect&&s.locationSelect.addEventListener("change",()=>{o.filters.location=s.locationSelect.value,o.currentPage=1,C()}),s.ageSelect&&s.ageSelect.addEventListener("change",()=>{o.filters.age=s.ageSelect.value,o.currentPage=1,C()}),s.sortSelect&&s.sortSelect.addEventListener("change",()=>{o.sortBy=s.sortSelect.value,o.currentPage=1,C()})}function ke(){s.activeFiltersContainer&&s.activeFiltersContainer.addEventListener("click",e=>{const t=e.target.closest(".filter-chip");if(!t)return;const i=t.dataset.key;i==="search"?(o.filters.search="",s.searchInput&&(s.searchInput.value="")):i==="type"?(o.filters.type="all",s.typeTabs.forEach(n=>{const a=n.dataset.type==="all";n.classList.toggle("active",a),n.setAttribute("aria-selected",a)})):(o.filters[i]="",s[`${i}Select`]&&(s[`${i}Select`].value="")),o.currentPage=1,C()})}function Ae(){s.clearFiltersBtn&&(s.clearFiltersBtn.addEventListener("click",z),s.resetFromEmpty&&s.resetFromEmpty.addEventListener("click",z))}function z(){o.filters={type:"all",pole:"",location:"",age:"",search:""},o.currentPage=1,s.typeTabs.forEach(e=>{const t=e.dataset.type==="all";e.classList.toggle("active",t),e.setAttribute("aria-selected",t)}),s.searchInput&&(s.searchInput.value=""),s.poleSelect&&(s.poleSelect.value=""),s.locationSelect&&(s.locationSelect.value=""),s.ageSelect&&(s.ageSelect.value=""),s.sortSelect&&(s.sortSelect.value="relevance"),C()}function xe(){s.viewButtons.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.view;we(t)})})}function Ie(){s.pagination&&s.pagination.addEventListener("click",e=>{const t=e.target.closest(".pagination-btn");if(!t||t.disabled)return;if(t.id==="prev-page"&&o.currentPage>1)o.currentPage--;else if(t.id==="next-page"){const a=$(o,E),r=Math.ceil(a.length/o.itemsPerPage);o.currentPage<r&&o.currentPage++}else t.dataset.page&&(o.currentPage=parseInt(t.dataset.page,10));const i=$(o,E);J(i);const n=document.querySelector(".results-section");n&&n.scrollIntoView({behavior:"smooth",block:"start"})})}function Ee(){s.gridView&&s.gridView.addEventListener("keydown",e=>{if(e.key==="Enter"||e.key===" "){const t=e.target.closest(".result-card");if(t){const i=t.querySelector("a[href]");i&&(e.preventDefault(),window.location.href=i.href)}}})}function C(){console.log("üîÑ applyFilters appel√©, viewMode:",o.viewMode),s.gridView&&(s.gridView.innerHTML=""),s.loading&&s.loading.classList.remove("hidden"),s.gridView&&s.gridView.classList.add("hidden"),s.mapView&&s.mapView.classList.add("hidden"),s.pagination&&s.pagination.classList.add("hidden"),s.emptyState&&s.emptyState.classList.add("hidden"),setTimeout(()=>{let e=$(o,E);e=pe(e,o.sortBy),console.log("üìä R√©sultats filtr√©s:",e.length),o.viewMode==="map"&&o.map&&(console.log("üó∫Ô∏è Mode carte, mise √† jour des marqueurs"),j(o.map,e)),o.viewMode!=="map"&&(console.log("üìã Mode liste, rendu des cartes"),J(e)),he(e.length),be(),ye(),s.loading&&s.loading.classList.add("hidden")},300)}function $e(e=document){var i;const t=e.getElementById("grid-view");if(!t){console.warn("‚ö†Ô∏è Grille de r√©sultats non trouv√©e (#grid-view). Filtres non initialis√©s.");return}s={typeTabs:e.querySelectorAll(".type-toggle-btn"),searchInput:e.getElementById("search"),poleSelect:e.getElementById("pole"),locationSelect:e.getElementById("location"),ageSelect:e.getElementById("age"),viewButtons:e.querySelectorAll(".view-toggle-btn"),clearFiltersBtn:e.getElementById("clear-filters"),activeFiltersContainer:e.getElementById("active-filters"),gridView:t,mapView:e.getElementById("map-view"),mapContainer:((i=e.querySelector("#map-view .map-placeholder"))==null?void 0:i.parentElement)||e.getElementById("map-view"),resultsCount:e.getElementById("results-count"),resultsTitle:e.getElementById("results-title"),emptyState:e.getElementById("empty-state"),loading:e.getElementById("loading"),pagination:e.getElementById("pagination"),sortSelect:e.getElementById("sort"),resetFromEmpty:e.getElementById("reset-from-empty")},Le(),Se(),Ce(),ke(),Ae(),xe(),Ie(),Ee(),C(),console.log("‚úÖ √âtablissements Filters initialized"),console.log(`üìä ${E.length} √©tablissements charg√©s`),console.log("üó∫Ô∏è Leaflet map ready (lazy-init on view toggle)")}const F=[{id:1,title:"√âducateur sp√©cialis√© H/F",type:"cdi",typeLabel:"CDI",location:"Cr√©teil",locationSlug:"creteil",metier:"educateur",metierLabel:"√âducateur sp√©cialis√©",description:"Accompagnement d'enfants et adolescents en situation de handicap au sein de notre IME. Projet p√©dagogique personnalis√©.",image:"https://images.unsplash.com/photo-1573497019940-1c28c88b4f3e?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",tags:["√âducation","Handicap","Jeunesse"],posted:"Il y a 3 jours",salary:"Selon convention collective",experience:"D√©butant accept√©",link:"offre-detail.html?id=1"},{id:2,title:"Moniteur d'atelier espaces verts H/F",type:"cdi",typeLabel:"CDI",location:"Saint-Maur-des-Foss√©s",locationSlug:"saint-maur",metier:"moniteur",metierLabel:"Moniteur d'atelier",description:"Encadrement de travailleurs en ESAT sur des activit√©s d'espaces verts et jardinage. Formation assur√©e.",image:"https://images.unsplash.com/photo-1556761175-b413da4baf72?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",tags:["ESAT","Espaces verts","Encadrement"],posted:"Il y a 5 jours",salary:"2200‚Ç¨ - 2500‚Ç¨ brut/mois",experience:"2 ans minimum",link:"offre-detail.html?id=2"},{id:3,title:"Aide-soignant H/F",type:"cdd",typeLabel:"CDD 6 mois",location:"Vitry-sur-Seine",locationSlug:"vitry",metier:"aide-soignant",metierLabel:"Aide-soignant",description:"Soins d'hygi√®ne et de confort aupr√®s de r√©sidents en FAM. Travail en √©quipe pluridisciplinaire.",image:"https://images.unsplash.com/photo-1576091160399-112ba8d25d1d?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",tags:["Soins","FAM","√âquipe"],posted:"Il y a 1 semaine",salary:"Selon grille FPH",experience:"Dipl√¥me requis",link:"offre-detail.html?id=3"},{id:4,title:"Infirmier dipl√¥m√© d'√âtat H/F",type:"cdi",typeLabel:"CDI",location:"Champigny-sur-Marne",locationSlug:"champigny",metier:"infirmier",metierLabel:"Infirmier",description:"Soins infirmiers, coordination avec les m√©decins, suivi des traitements. MAS de 50 r√©sidents.",image:"https://images.unsplash.com/photo-1581093450021-4a7360e9a6b5?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",tags:["Soins","MAS","Coordination"],posted:"Il y a 2 jours",salary:"2400‚Ç¨ - 2800‚Ç¨ brut/mois",experience:"1 an minimum",link:"offre-detail.html?id=4"},{id:5,title:"Psychologue clinicien H/F",type:"cdi",typeLabel:"CDI",location:"Cr√©teil",locationSlug:"creteil",metier:"psychologue",metierLabel:"Psychologue",description:"√âvaluations psychologiques, suivis th√©rapeutiques, soutien aux √©quipes. Master 2 requis.",image:"https://images.unsplash.com/photo-1573497019940-1c28c88b4f3e?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",tags:["Psychologie","√âvaluation","Th√©rapie"],posted:"Il y a 4 jours",salary:"Selon exp√©rience",experience:"3 ans minimum",link:"offre-detail.html?id=5"},{id:6,title:"Directeur d'√©tablissement H/F",type:"cdi",typeLabel:"CDI",location:"Ivry-sur-Seine",locationSlug:"ivry",metier:"directeur",metierLabel:"Directeur",description:"Direction d'un foyer d'h√©bergement de 45 r√©sidents. Management d'√©quipe, gestion budg√©taire.",image:"https://images.unsplash.com/photo-1556761175-b413da4baf72?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",tags:["Direction","Management","Gestion"],posted:"Il y a 1 semaine",salary:"Selon profil",experience:"5 ans minimum",link:"offre-detail.html?id=6"},{id:7,title:"√âducateur de jeunes enfants H/F",type:"cdd",typeLabel:"CDD 12 mois",location:"Bonneuil-sur-Marne",locationSlug:"bonneuil",metier:"educateur",metierLabel:"√âducateur sp√©cialis√©",description:"Accompagnement de jeunes enfants en situation de handicap. UEMA (unit√© autiste).",image:"https://images.unsplash.com/photo-1576091160399-112ba8d25d1d?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",tags:["Petite enfance","Autisme","√âducation"],posted:"Il y a 3 jours",salary:"Selon grille FPH",experience:"D√©butant accept√©",link:"offre-detail.html?id=7"}],c={filters:{type:"",metier:"",location:"",search:""},activeChips:[],currentPage:1,itemsPerPage:6,sortBy:"date"};let l={};function Be(e,t){let i;return function(...a){const r=()=>{clearTimeout(i),e(...a)};clearTimeout(i),i=setTimeout(r,t)}}function S(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function _(e,t){let i=[...t];if(e.filters.type&&(i=i.filter(n=>n.type===e.filters.type)),e.filters.metier&&(i=i.filter(n=>n.metier===e.filters.metier)),e.filters.location&&(i=i.filter(n=>n.locationSlug===e.filters.location)),e.filters.search){const n=e.filters.search.toLowerCase();i=i.filter(a=>a.title.toLowerCase().includes(n)||a.location.toLowerCase().includes(n)||a.description.toLowerCase().includes(n)||a.tags.some(r=>r.toLowerCase().includes(n)))}return i}function Me(e,t){switch(t){case"date-asc":return e.sort((i,n)=>i.posted.localeCompare(n.posted));case"date-desc":return e.sort((i,n)=>n.posted.localeCompare(i.posted));case"location":return e.sort((i,n)=>i.location.localeCompare(n.location));default:return e}}function Pe(e,t,i){const n=Math.ceil(e.length/i),a=(t-1)*i;return{items:e.slice(a,a+i),totalPages:n}}function qe(e){return`
    <article class="job-card" role="listitem" tabindex="0" aria-labelledby="job-title-${e.id}">
      <div class="job-card__media">
        <img src="${e.image}" alt="${S(e.title)} - ${S(e.location)}" loading="lazy">
        <span class="job-card__type">${S(e.type)}</span>
      </div>
      <div class="job-card__content">
        <h3 class="job-card__title" id="job-title-${e.id}">
          <a href="${e.link}">${S(e.title)}</a>
        </h3>
        <p class="job-card__location">${S(e.location)}</p>
        <p class="job-card__description">${S(e.description)}</p>
        <div class="job-card__meta">
          <span class="meta-item">${S(e.experience)}</span>
          <span class="meta-item">${S(e.posted)}</span>
        </div>
        <div class="job-card__tags">
          ${e.tags.slice(0,3).map(t=>`<span class="tag">${S(t)}</span>`).join("")}
        </div>
        <div class="job-card__actions">
          <a href="${e.link}" class="btn btn-primary">Voir l'offre ‚Üí</a>
        </div>
      </div>
    </article>
  `}function Q(e){const{items:t,totalPages:i}=Pe(e,c.currentPage,c.itemsPerPage);if(t.length===0){l.gridView&&(l.gridView.classList.add("hidden"),l.gridView.hidden=!0),l.emptyState&&(l.emptyState.classList.remove("hidden"),l.emptyState.hidden=!1),l.pagination&&(l.pagination.classList.add("hidden"),l.pagination.hidden=!0);return}l.emptyState&&(l.emptyState.classList.add("hidden"),l.emptyState.hidden=!0),l.gridView&&(l.gridView.classList.remove("hidden"),l.gridView.hidden=!1,l.gridView.innerHTML=t.map(n=>qe(n)).join("")),i>1&&l.pagination?(Fe(i),l.pagination.classList.remove("hidden"),l.pagination.hidden=!1):l.pagination&&(l.pagination.classList.add("hidden"),l.pagination.hidden=!0)}function Fe(e){let t="";t+=`<button class="pagination-btn" id="prev-page" aria-label="Page pr√©c√©dente" ${c.currentPage===1?"disabled":""}>
    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <path d="M12.5 15L7.5 10L12.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>`;const i=5;let n=Math.max(1,c.currentPage-Math.floor(i/2)),a=Math.min(e,n+i-1);a-n+1<i&&(n=Math.max(1,a-i+1)),n>1&&(t+='<button class="pagination-btn" data-page="1">1</button>',n>2&&(t+='<span class="pagination-ellipsis">‚Ä¶</span>'));for(let r=n;r<=a;r++)t+=`<button class="pagination-btn ${r===c.currentPage?"active":""}" 
      data-page="${r}" 
      aria-current="${r===c.currentPage?"page":"false"}"
      aria-label="Page ${r}">${r}</button>`;a<e&&(a<e-1&&(t+='<span class="pagination-ellipsis">‚Ä¶</span>'),t+=`<button class="pagination-btn" data-page="${e}">${e}</button>`),t+=`<button class="pagination-btn" id="next-page" aria-label="Page suivante" ${c.currentPage===e?"disabled":""}>
    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <path d="M7.5 5L12.5 10L7.5 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>`,l.pagination&&(l.pagination.innerHTML=t)}function De(e){if(l.resultsCount){const t=e>1?"s":"";l.resultsCount.textContent=`${e} offre${t}`}}function Ve(){if(!l.activeFiltersContainer)return;const e=[];if(c.filters.type){const t={cdi:"CDI",cdd:"CDD",interim:"Int√©rim",stage:"Stage"};e.push({key:"type",label:t[c.filters.type]||c.filters.type,value:c.filters.type})}if(c.filters.metier){const t={educateur:"√âducateur sp√©cialis√©","aide-soignant":"Aide-soignant",infirmier:"Infirmier",moniteur:"Moniteur d'atelier",psychologue:"Psychologue",directeur:"Directeur"};e.push({key:"metier",label:t[c.filters.metier]||c.filters.metier,value:c.filters.metier})}if(c.filters.location){const t={creteil:"Cr√©teil","saint-maur":"Saint-Maur",vitry:"Vitry-sur-Seine",champigny:"Champigny-sur-Marne",ivry:"Ivry-sur-Seine",bonneuil:"Bonneuil-sur-Marne"};e.push({key:"location",label:t[c.filters.location]||c.filters.location,value:c.filters.location})}c.filters.search&&e.push({key:"search",label:`"${c.filters.search}"`,value:c.filters.search}),c.activeChips=e,e.length>0?l.activeFiltersContainer.innerHTML=e.map(t=>`
      <button class="filter-chip active" data-key="${t.key}" data-value="${t.value}" aria-label="Supprimer le filtre ${t.label}">
        ${t.label}
        <span class="remove" aria-hidden="true">√ó</span>
      </button>
    `).join(""):l.activeFiltersContainer.innerHTML=""}function Te(){if(l.clearFiltersBtn){const e=c.filters.type||c.filters.metier||c.filters.location||c.filters.search;l.clearFiltersBtn.hidden=!e}}function je(){l.typeSelect&&l.typeSelect.addEventListener("change",e=>{c.filters.type=e.target.value,c.currentPage=1,k()}),l.metierSelect&&l.metierSelect.addEventListener("change",e=>{c.filters.metier=e.target.value,c.currentPage=1,k()}),l.locationSelect&&l.locationSelect.addEventListener("change",e=>{c.filters.location=e.target.value,c.currentPage=1,k()}),l.sortSelect&&l.sortSelect.addEventListener("change",e=>{c.sortBy=e.target.value,c.currentPage=1,k()})}function _e(){if(!l.searchInput)return;const e=Be(()=>{c.filters.search=l.searchInput.value.trim(),c.currentPage=1,k()},300);l.searchInput.addEventListener("input",e)}function He(){l.activeFiltersContainer&&l.activeFiltersContainer.addEventListener("click",e=>{const t=e.target.closest(".filter-chip");if(!t)return;const i=t.dataset.key;i==="search"?(c.filters.search="",l.searchInput&&(l.searchInput.value="")):i==="type"?(c.filters.type="",l.typeSelect&&(l.typeSelect.value="")):(c.filters[i]="",l[`${i}Select`]&&(l[`${i}Select`].value="")),c.currentPage=1,k()})}function Oe(){l.clearFiltersBtn&&l.clearFiltersBtn.addEventListener("click",()=>{c.filters={type:"",pole:"",location:"",search:""},c.currentPage=1,l.searchInput&&(l.searchInput.value=""),l.typeSelect&&(l.typeSelect.value=""),l.poleSelect&&(l.poleSelect.value=""),l.locationSelect&&(l.locationSelect.value=""),l.sortSelect&&(l.sortSelect.value="date"),k()})}function Re(){l.pagination&&l.pagination.addEventListener("click",e=>{const t=e.target.closest(".pagination-btn");if(!t||t.disabled)return;if(t.id==="prev-page"&&c.currentPage>1)c.currentPage--;else if(t.id==="next-page"){const a=_(c,F),r=Math.ceil(a.length/c.itemsPerPage);c.currentPage<r&&c.currentPage++}else t.dataset.page&&(c.currentPage=parseInt(t.dataset.page,10));const i=_(c,F);Q(i);const n=document.querySelector(".results-section");n&&n.scrollIntoView({behavior:"smooth",block:"start"})})}function k(){l.gridView&&(l.gridView.innerHTML=""),l.loading&&l.loading.classList.remove("hidden"),l.gridView&&l.gridView.classList.add("hidden"),l.pagination&&l.pagination.classList.add("hidden"),l.emptyState&&l.emptyState.classList.add("hidden"),setTimeout(()=>{let e=_(c,F);e=Me(e,c.sortBy),Q(e),De(e.length),Ve(),Te(),l.loading&&l.loading.classList.add("hidden")},300)}function Je(e=document){const t=e.getElementById("jobs-grid");if(!t){console.warn("Grille de jobs non trouv√©e (#jobs-grid). Filtres non initialis√©s.");return}l={searchInput:e.getElementById("job-search"),typeSelect:e.getElementById("job-type"),metierSelect:e.getElementById("job-metier"),locationSelect:e.getElementById("job-location"),sortSelect:null,clearFiltersBtn:e.getElementById("clear-filters"),activeFiltersContainer:e.getElementById("active-filters"),gridView:t,resultsCount:e.getElementById("jobs-count"),emptyState:e.getElementById("empty-state"),loading:e.getElementById("loading"),pagination:null},je(),_e(),He(),Oe(),Re(),k(),console.log("Career Filters initialized"),console.log(`${F.length} offres charg√©es`)}const d={currentStep:1,totalSteps:3,formData:{civilite:"",nom:"",prenom:"",email:"",telephone:"",adresse:"",codePostal:"",ville:"",formation:"",experience:"",disponibilite:"",permisB:!1,cv:null,lettre:null,pieces:null},errors:{}};let f={};function Ge(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function Ne(e){return/^[\d\s.+-]{10,}$/.test(e)}function ze(e){var n,a;console.log(`üîç validateStep(${e}) appel√©`);const t={};e===1&&(console.log("  Validation √©tape 1: Coordonn√©es"),(!d.formData.nom||d.formData.nom.trim()==="")&&(t.nom="Le nom est obligatoire",console.log("    Erreur: nom vide")),(!d.formData.prenom||d.formData.prenom.trim()==="")&&(t.prenom="Le pr√©nom est obligatoire",console.log("    Erreur: prenom vide")),!d.formData.email||d.formData.email.trim()===""?(t.email="L'email est obligatoire",console.log("    Erreur: email vide")):Ge(d.formData.email)||(t.email="L'email n'est pas valide",console.log("    Erreur: email invalide")),d.formData.telephone&&!Ne(d.formData.telephone)&&(t.telephone="Le t√©l√©phone n'est pas valide",console.log("    Erreur: telephone invalide"))),e===2&&(console.log("  Validation √©tape 2: Parcours"),console.log(`    message (lettre): "${(n=d.formData.message)==null?void 0:n.substring(0,50)}..."`),console.log(`    experience: "${(a=d.formData.experience)==null?void 0:a.substring(0,50)}..."`),console.log(`    disponibilite: "${d.formData.disponibilite}"`),(!d.formData.message||d.formData.message.trim().length<100)&&(t.message="La lettre de motivation doit faire au moins 100 caract√®res",console.log("    Erreur: lettre trop courte")),(!d.formData.experience||d.formData.experience.trim().length<50)&&(t.experience="L'exp√©rience doit faire au moins 50 caract√®res",console.log("    Erreur: experience trop courte")),(!d.formData.disponibilite||d.formData.disponibilite.trim()==="")&&(t.disponibilite="La disponibilit√© est obligatoire",console.log("    Erreur: disponibilite vide"))),e===3&&(console.log("  Validation √©tape 3: Documents"),d.formData.cv||(t.cv="Le CV est obligatoire",console.log("    Erreur: cv manquant")),d.formData.rgpd||(t.rgpd="Vous devez accepter la politique de confidentialit√©",console.log("    Erreur: rgpd non coch√©"))),d.errors=t;const i=Object.keys(t).length===0;return console.log(`  Validation ${i?"R√âUSSIE":"√âCHOU√â"}: ${Object.keys(t).length} erreurs`),i}function Ue(){(f.progressSteps||[]).forEach((i,n)=>{const a=n+1;a<d.currentStep?(i.classList.add("completed"),i.classList.remove("active"),i.querySelector(".progress-step-number").innerHTML="‚úì"):a===d.currentStep?(i.classList.add("active"),i.classList.remove("completed"),i.querySelector(".progress-step-number").textContent=a):(i.classList.remove("active"),i.classList.remove("completed"),i.querySelector(".progress-step-number").textContent=a)});const t=f.progressBar;t&&t.setAttribute("aria-valuenow",d.currentStep)}function G(e){console.log(`üìç showStep(${e}) appel√©`);const t=f.formSections||[];console.log(`  ${t.length} sections trouv√©es`),t.forEach((n,a)=>{const r=a+1,u=r===e;console.log(`  Section ${r}: ${u?"VISIBLE":"CACH√âE"}`),u?(n.classList.remove("hidden"),n.hidden=!1,n.style.display="block"):(n.classList.add("hidden"),n.hidden=!0,n.style.display="none")}),Ue(),Ke();const i=f.formContainer;i&&i.scrollIntoView({behavior:"smooth",block:"start"})}function Ke(){var e;f.prevBtn&&(f.prevBtn.style.visibility=d.currentStep===1?"hidden":"visible"),f.nextBtn&&(d.currentStep===d.totalSteps?(f.nextBtn.textContent="Envoyer ma candidature",(e=f.nextBtn.querySelector("svg"))==null||e.remove()):f.nextBtn.innerHTML=`
        Suivant
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <path d="M7.5 5L12.5 10L7.5 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      `)}function Ze(e){document.querySelectorAll(".form-error.visible").forEach(t=>{t.classList.remove("visible")}),document.querySelectorAll(".form-input.error, .form-textarea.error, .form-select.error").forEach(t=>{t.classList.remove("error")}),Object.keys(d.errors).forEach(t=>{const i=document.getElementById(t),n=document.getElementById(`${t}-error`);i&&i.classList.add("error"),n&&d.errors[t]&&(n.textContent=d.errors[t],n.classList.add("visible"))})}function We(){console.log("‚úÖ Affichage du message de succ√®s");const e=f.form;e&&(e.classList.add("hidden"),e.hidden=!0,e.style.display="none",console.log("  Formulaire cach√©"));const t=document.querySelector(".progress-steps");t&&(t.style.display="none");const i=document.querySelector(".job-summary");i&&(i.style.display="none");const n=document.querySelector(".form-header");n&&(n.style.display="none"),f.successMessage&&(f.successMessage.classList.remove("hidden"),f.successMessage.hidden=!1,f.successMessage.style.display="block",f.successMessage.classList.add("visible"),console.log("  Message de succ√®s affich√©")),window.scrollTo({top:0,behavior:"smooth"})}function Qe(e){const t=e.target.id,i=e.target.type==="checkbox"?e.target.checked:e.target.value;if(d.formData[t]=i,d.errors[t]){delete d.errors[t];const n=document.getElementById(t),a=document.getElementById(`${t}-error`);n&&n.classList.remove("error"),a&&a.classList.remove("visible")}}function Xe(e){const t=e.target.id,i=e.target.files[0];if(console.log(`üìé handleFileChange: ${t}`,i?i.name:"aucun fichier"),i){d.formData[t]=i;const n=e.target.closest(".form-file-wrapper");if(n){let a=n.querySelector(".file-name");a||(a=document.createElement("p"),a.className="file-name",a.style.cssText="margin-top: var(--space-sm); font-weight: var(--font-weight-semibold);",n.insertBefore(a,n.querySelector(".file-types").nextSibling)),a.textContent=`‚úì ${i.name} (${(i.size/1024).toFixed(1)} KB)`,a.style.color="var(--color-text-success)";const r=document.getElementById(`${t}-error`);r&&r.classList.remove("visible"),e.target.classList.remove("error"),console.log(`  ‚úÖ Fichier ${t} charg√©: ${i.name}`)}}}function H(){if(console.log(`üîµ handleNext() appel√© - currentStep: ${d.currentStep}`),ze(d.currentStep))console.log("‚úÖ Validation r√©ussie"),d.currentStep<d.totalSteps?(d.currentStep++,console.log(`‚û°Ô∏è Passage √† l'√©tape ${d.currentStep}`),G(d.currentStep),window.scrollTo({top:0,behavior:"smooth"})):(console.log("üì§ Envoi du formulaire"),Ye());else{console.log("‚ùå Validation √©chou√©e:",d.errors),Ze();const e=document.querySelector(".form-input.error, .form-textarea.error, .form-select.error");e&&e.scrollIntoView({behavior:"smooth",block:"center"})}}function X(){d.currentStep>1&&(d.currentStep--,G(d.currentStep))}function Ye(){const e=f.nextBtn;e.innerHTML,e.disabled=!0,e.innerHTML="Envoi en cours...",setTimeout(()=>{console.log("‚úÖ Formulaire soumis avec succ√®s"),console.log("üìÑ Donn√©es:",d.formData),We(),d.currentStep=1,d.formData={civilite:"",nom:"",prenom:"",email:"",telephone:"",adresse:"",codePostal:"",ville:"",formation:"",experience:"",disponibilite:"",permisB:!1,cv:null,lettre:null,pieces:null}},2e3)}typeof window<"u"&&(window.nextStep=function(e){console.log(`üîò nextStep(${e}) called from inline handler`),H()},window.previousStep=function(e){console.log(`üîô previousStep(${e}) called from inline handler`),X()});function et(e=document){const t=e.getElementById("application-form");if(!t){console.warn("‚ö†Ô∏è Formulaire non trouv√© (#application-form). Module non initialis√©.");return}console.log("üîç Initialisation du formulaire..."),f={formContainer:e.querySelector(".form-container"),successMessage:e.getElementById("success-message"),progressSteps:e.querySelectorAll(".progress-steps .progress-step"),progressBar:e.querySelector('[role="progressbar"]'),formSections:e.querySelectorAll(".form-section[data-step]"),prevBtn:e.querySelector('button[data-action="prev"]'),nextBtn:e.querySelector('button[data-action="next"]'),form:t},console.log(`üì¶ √âl√©ments trouv√©s: ${f.formSections.length} sections`),f.formSections.forEach((n,a)=>{n.style.display="block",n.hidden=!1,n.classList.remove("hidden"),console.log(`  Section ${a+1}: display=block`)});const i=t.querySelectorAll("input, textarea, select");console.log(`üìã ${i.length} inputs trouv√©s`),i.forEach(n=>{console.log(`  Input: ${n.id} (${n.type})`),n.type==="file"?(n.addEventListener("change",Xe),console.log("    ‚Üí Event listener change ajout√©")):n.addEventListener("input",Qe)}),t.addEventListener("click",n=>{const a=n.target.closest("button");if(!a)return;const r=a.getAttribute("data-action"),u=a.getAttribute("data-trigger");if(r==="next")n.preventDefault(),H();else if(r==="prev")n.preventDefault(),X();else if(u==="file"){const b=a.getAttribute("data-target");if(b){n.preventDefault();const y=e.getElementById(b);y&&y.type==="file"&&y.click()}}}),t.addEventListener("submit",n=>{n.preventDefault(),console.log("üì§ Formulaire soumis - handling submission"),d.currentStep===d.totalSteps&&H()}),console.log("‚úÖ Affichage √©tape 1"),G(1),console.log("‚úÖ Application Form initialized"),console.log(`üìù ${d.totalSteps} √©tapes`)}const tt=["Pr√©sentation","Services","√âquipe","Acc√®s"];let U=0,N=null,B=[],p=null;function it(e){const t=e.querySelector(".content-section");if(!t||e.querySelectorAll(".content-section").length<4)return;const i=document.createElement("nav");i.setAttribute("aria-label","Contenu de l'√©tablissement"),i.className="establishment-tabs",i.innerHTML='<div class="establishment-tabs__list" role="tablist"></div>';const n=i.querySelector('[role="tablist"]');tt.forEach((a,r)=>{const u=document.createElement("button");u.type="button",u.role="tab",u.id=`establishment-tab-${r+1}`,u.setAttribute("aria-selected",r===0?"true":"false"),u.setAttribute("aria-controls",`establishment-panel-${r+1}`),u.className="establishment-tabs__tab btn btn-ghost",r===0&&u.classList.add("active"),u.textContent=a,u.addEventListener("click",()=>Y(r)),u.addEventListener("keydown",b=>nt(b,r)),n.appendChild(u)}),e.insertBefore(i,t),N=n}function Y(e){if(e===U||e<0||e>=B.length)return;U=e,N.querySelectorAll('[role="tab"]').forEach((i,n)=>{const a=n===e;i.setAttribute("aria-selected",a?"true":"false"),i.classList.toggle("active",a)}),B.forEach((i,n)=>{const a=n===e;i.hidden=!a,i.classList.toggle("hidden",!a),i.style.display=a?"block":"none"})}function nt(e,t){let i=t;if(e.key==="ArrowRight"||e.key==="ArrowDown")e.preventDefault(),i=Math.min(t+1,B.length-1);else if(e.key==="ArrowLeft"||e.key==="ArrowUp")e.preventDefault(),i=Math.max(t-1,0);else if(e.key==="Home")e.preventDefault(),i=0;else if(e.key==="End")e.preventDefault(),i=B.length-1;else return;Y(i),N.querySelectorAll('[role="tab"]')[i].focus()}function at(e){const t=e.querySelectorAll(".content-section");B=Array.from(t).slice(0,4),B.forEach((i,n)=>{i.setAttribute("role","tabpanel"),i.id=`establishment-panel-${n+1}`,i.setAttribute("aria-labelledby",`establishment-tab-${n+1}`),n>0&&(i.hidden=!0,i.classList.add("hidden"),i.style.display="none")})}function st(e){const t=e.querySelector(".detail-hero-media img"),i=e.querySelector(".media-gallery-trigger"),n=[];if(t&&t.src&&n.push({src:t.src,alt:t.alt||"Photo de l'√©tablissement"}),i&&i.dataset.gallery)try{const a=JSON.parse(i.dataset.gallery);Array.isArray(a)&&a.forEach(r=>n.push(typeof r=="string"?{src:r,alt:""}:r))}catch{}return n.length===0&&t&&n.push({src:t.src,alt:t.alt||"Photo"}),n}function K(e,t=0){const i=st(e);if(i.length===0)return;if(!p){let P=function(x,m){D=m;const V=x[m];A.src=V.src||V,A.alt=V.alt||`Photo ${m+1}`,b.style.visibility=x.length>1?"visible":"hidden",y.style.visibility=x.length>1?"visible":"hidden"};var a=P;p=document.createElement("div"),p.className="establishment-lightbox",p.setAttribute("role","dialog"),p.setAttribute("aria-modal","true"),p.setAttribute("aria-label","Galerie photos"),p.innerHTML=`
      <div class="establishment-lightbox__backdrop"></div>
      <div class="establishment-lightbox__content">
        <button type="button" class="establishment-lightbox__close" aria-label="Fermer la galerie">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <button type="button" class="establishment-lightbox__prev" aria-label="Photo pr√©c√©dente">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <img class="establishment-lightbox__img" src="" alt="">
        <button type="button" class="establishment-lightbox__next" aria-label="Photo suivante">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
    `,document.body.appendChild(p);const r=p.querySelector(".establishment-lightbox__backdrop"),u=p.querySelector(".establishment-lightbox__close"),b=p.querySelector(".establishment-lightbox__prev"),y=p.querySelector(".establishment-lightbox__next"),A=p.querySelector(".establishment-lightbox__img"),M=()=>{p.classList.remove("visible"),document.body.style.overflow="",p.setAttribute("aria-hidden","true")};r.addEventListener("click",M),u.addEventListener("click",M),b.addEventListener("click",x=>{x.stopPropagation();const m=p._currentImages||[];m.length&&P(m,(D-1+m.length)%m.length)}),y.addEventListener("click",x=>{x.stopPropagation();const m=p._currentImages||[];m.length&&P(m,(D+1)%m.length)});let D=0;p._showImage=P}p._currentImages=i,p._showImage(i,t),p.classList.add("visible"),p.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",p.querySelector(".establishment-lightbox__close").focus();const n=r=>{r.key==="Escape"&&(p.classList.remove("visible"),document.body.style.overflow="",p.setAttribute("aria-hidden","true"),document.removeEventListener("keydown",n))};document.addEventListener("keydown",n)}function ot(e=document){const t=e.querySelector(".section-padding .container");if(!t)return;t.querySelectorAll(".content-section").length>=4&&(at(t),it(t));const n=e.querySelector(".media-gallery-trigger");n&&(n.addEventListener("click",a=>{a.preventDefault(),K(e,0)}),n.addEventListener("keydown",a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),K(e,0))}))}function rt(){window.print()}function lt(e){const t=encodeURIComponent(window.location.href),i=encodeURIComponent(document.title||"Offre d'emploi - Apogei 94"),n=encodeURIComponent(`${document.title||"Offre d'emploi"}
${window.location.href}`);let a="";e==="linkedin"?a=`https://www.linkedin.com/sharing/share-offsite/?url=${t}`:e==="facebook"?a=`https://www.facebook.com/sharer/sharer.php?u=${t}`:e==="email"&&(a=`mailto:?subject=${i}&body=${n}`),a&&window.open(a,e==="email"?"_self":"share","width=600,height=400,noopener")}function ct(e=document){const t=e.querySelector('[data-action="print"]');t&&t.addEventListener("click",n=>{n.preventDefault(),rt()}),e.querySelectorAll(".share-btn[data-share]").forEach(n=>{const a=n.getAttribute("data-share").toLowerCase();["linkedin","facebook","email"].includes(a)&&n.addEventListener("click",r=>{r.preventDefault(),lt(a)})})}let h=null,w=null,g=null,T=null;function O(){return(h==null?void 0:h.classList.contains("menu-open"))??!1}function dt(){if(!h||!w||!g)return;h.classList.add("menu-open"),w.classList.add("is-open"),g.setAttribute("aria-expanded","true"),g.setAttribute("aria-label","Fermer le menu"),document.body.style.overflow="hidden";const e=w.querySelector("a");e&&e.focus()}function q(){!h||!w||!g||(h.classList.remove("menu-open"),w.classList.remove("is-open"),g.setAttribute("aria-expanded","false"),g.setAttribute("aria-label","Ouvrir le menu"),document.body.style.overflow="",g.focus())}function ut(e){if(e.key==="Escape"&&O()&&q(),e.key==="Tab"&&O()&&w){const t=w.querySelectorAll('a[href], button, [tabindex]:not([tabindex="-1"])');if(!t.length)return;const i=t[0],n=t[t.length-1];(e.shiftKey&&document.activeElement===i||!e.shiftKey&&document.activeElement===n)&&(e.preventDefault(),g==null||g.focus())}}function pt(e=document){if(h=e.getElementById("site-header"),!h||(g=h.querySelector(".menu-toggle"),w=h.querySelector(".main-nav"),T=h.querySelector(".menu-overlay"),!g||!w))return;g.addEventListener("click",()=>{O()?q():dt()});const t=w.querySelector(".menu-close");t&&t.addEventListener("click",q),T&&T.addEventListener("click",q),e.addEventListener("keydown",ut)}function Z(){ne(document),pt(document),document.getElementById("donate-form")&&de(document),(document.querySelector('[data-page="etablissements"]')||document.getElementById("grid-view"))&&$e(document),(document.getElementById("jobs-grid")||document.querySelector('[data-page="carrieres"]'))&&Je(document),(document.getElementById("application-form")||document.querySelector('[data-page="postuler"]'))&&et(document),(document.querySelector(".detail-hero")||document.querySelector(".media-gallery-trigger"))&&ot(document),(document.querySelector(".job-hero")||document.querySelector(".share-buttons"))&&ct(document),console.log("‚úÖ Apogei 94 JavaScript initialized")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Z):Z();
